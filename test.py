from scapy.all import *
from smtp import *

def parse_req(data):
    hex_data = hex_bytes(data)
    print("req传入的参数：", hex_data)
    result = SMTPRequest(hex_data)
    result.show()

def parse_res(data):
    hex_data = hex_bytes(data)
    print("res传入的参数：", hex_data)
    result = SMTPResponse(hex_data)
    result.show()

def parse_data(data):
    hex_data = hex_bytes(data)
    print("data：", hex_data)
    result = SMTPDataField(hex_data)
    result.show()


def test_parse_smtp_req():
    pass
    # parse_req("5a33567963474679644746775148426864484a706233527a4c6d6c750d0a")
    # parse_req("515549540d0a")
    # parse_req("5243505420544f3a203c72616a5f64656f6c32303032696e407961686f6f2e636f2e696e3e0d0a")

def test_parse_smtp_res():
    pass
    # parse_res("")
    # parse_res("3235302d786339302e7765627369746577656c636f6d652e636f6d2048656c6c6f204750205b3132322e3136322e3134332e3135375d0d0a3235302d53495a452035323432383830300d0a3235302d504950454c494e494e470d0a3235302d4155544820504c41494e204c4f47494e0d0a3235302d5354415254544c530d0a3235302048454c500d0a")
    # parse_res("333334205547467a63336476636d51360d0a")
    # parse_res("3232302d786339302e7765627369746577656c636f6d652e636f6d2045534d5450204578696d20342e3639202331204d6f6e2c203035204f637420323030392030313a30353a3534202d30353030200d0a3232302d576520646f206e6f7420617574686f72697a652074686520757365206f6620746869732073797374656d20746f207472616e73706f727420756e736f6c6963697465642c200d0a32323020616e642f6f722062756c6b20652d6d61696c2e0d0a")
    # parse_res("3233352041757468656e7469636174696f6e207375636365656465640d0a")
    # parse_res("323530204f4b2069643d314d7567686f2d3030303344672d556e0d0a")

def test_parse_smtp_data():
    # pass
    # parse_data("0a0d0a3c7020636c6173733d33444d736f4e6f726d616c3e48656c6c6f3c6f3a703e3c2f6f3a703e3c2f703e0d0a0d0a3c7020636c6173733d33444d736f4e6f726d616c3e3c6f3a703e266e6273703b3c2f6f3a703e3c2f703e0d0a0d0a3c7020636c6173733d33444d736f4e6f726d616c3e492073656e64207520736d747020706361702066696c65203c6f3a703e3c2f6f3a703e3c2f703e0d0a0d0a3c7020636c6173733d33444d736f4e6f726d616c3e46696e6420746865206174746163686d656e743c6f3a703e3c2f6f3a703e3c2f703e0d0a0d0a3c7020636c6173733d33444d736f4e6f726d616c3e3c6f3a703e266e6273703b3c2f6f3a703e3c2f703e0d0a0d0a3c7020636c6173733d33444d736f4e6f726d616c3e4750533c6f3a703e3c2f6f3a703e3c2f703e0d0a0d0a3c2f6469763e0d0a0d0a3c2f626f64793e0d0a0d0a3c2f68746d6c3e0d0a0d0a2d2d2d2d2d2d3d5f4e657874506172745f3030315f303030355f30314341343542302e30393536393346302d2d0d0a0d0a2d2d2d2d2d2d3d5f4e657874506172745f3030305f303030345f30314341343542302e30393536393346300d0a436f6e74656e742d547970653a20746578742f706c61696e3b0d0a096e616d653d224e4557532e747874220d0a436f6e74656e742d5472616e736665722d456e636f64696e673a2071756f7465642d7072696e7461626c650d0a436f6e74656e742d446973706f736974696f6e3a206174746163686d656e743b0d0a0966696c656e616d653d224e4557532e747874220d0a0d0a56657273696f6e20342e392e392e310d0a2a204d616e79206275672066697865730d0a2a20496d70726f76656420656469746f720d0a0d0a56657273696f6e20342e392e392e300d0a2a20537570706f727420666f72206c6174657374204d696e677720636f6d70696c65722073797374656d206275696c64730d0a2a204275672066697865730d0a0d0a56657273696f6e20342e392e382e390d0a2a204e657720636f646520746f6f6c74697020646973706c61790d0a2a20496d70726f76656420496e64656e742f556e696e64656e7420616e642052656d6f766520436f6d6d656e740d0a2a20496d70726f766564206175746f6d6174696320696e64656e740d0a2a20416464656420737570706f727420666f72207468652022696e7465726661636522206b6579776f72640d0a2a205765625570646174652073686f756c64206e6f77207265706f727420696e7374616c6c6174696f6e2070726f626c656d732066726f6d205061636b4d616e0d0a2a204e65772073706c6173682073637265656e20616e64206173736f63696174696f6e2069636f6e730d0a2a20496d70726f76656420696e7374616c6c65720d0a2a204d616e79206275672066697865730d0a0d0a56657273696f6e20342e392e382e370d0a2a20416464656420737570706f727420666f7220474343203e20332e320d0a2a204465627567207661726961626c657320617265206e6f7720726573656e7420647572696e67206e6578742064656275672073657373696f6e0d0a2a2057617463686564205661726961626c6573206e6f7420696e20636f727265637420636f6e7465787420617265206e6f77206b65707420616e642075706461746564207768656e203d0d0a6974206973206e65656465640d0a2a204164646564206e657720636f6d70696c65722f6c696e6b6572206f7074696f6e733a3d32300d0a20202d2053747269702065786563757461626c650d0a20202d2047656e657261746520696e737472756374696f6e7320666f722061207370656369666963206d616368696e652028693338362c20693438362c20693538362c203d0d0a693638362c2070656e7469756d2c2070656e7469756d2d6d6d782c2070656e7469756d70726f2c2070656e7469756d322c2070656e7469756d332c2070656e7469756d342c3d32300d0a202020206b362c206b362d322c206b362d33")
    parse_data("6c6573202864697361626c6564202d20776f726b203d0d0a696e2070726f6772657373292e0d0a0d0a56657273696f6e20342e392e352e320d0a2a204164646564206e6577206f7074696f6e20696e20636c6173732d62726f777365723a2055736520636f6c6f72730d0a202028617661696c61626c65207768656e2072696768742d636c69636b696e672074686520636c6173732d62726f777365720d0a2020616e642073656c656374696e67202256696577206d6f646522292e0d0a2a204465762d432b2b206e6f77207472617073206163636573732076696f6c6174696f6e206f6620796f75722070726f6772616d732028616e64206f6620697473656c6620746f6f203d0d0a3b290d0a0d0a56657273696f6e20342e392e352e310d0a2a20496d706c656d656e74656420746865202246696c652f4578706f72742f50726f6a65637420746f2048544d4c222066756e6374696f6e2e0d0a2a2041646465642022546970206f662074686520646179222073797374656d2e0d0a2a205768656e2072756e6e696e67206120736f757263652066696c6520696e206578706c6f7265722c20646f6e277420737061776e206e657720696e7374616e63652e0d0a2020496e7374656164206f70656e207468652066696c6520696e20616e20616c7265616479206c61756e63686564204465762d432b2b2e0d0a2a20436c6173732d7061727365722073706565642d7570202835302520746f2038352520696d70726f76656d656e742074696d6564212121290d0a2a204d616e7920636f64652d636f6d706c6574696f6e20757064617465732e204e6f772074616b657320696e746f206163636f756e7420636f6e746578742c0d0a2020636c61737320696e6865726974616e636520616e64207669736962696c697479202873686f7773206974656d73206f6e6c792066726f6d2066696c65730d0a202023696e636c75646564206469726563746c79206f7220696e6469726563746c7929210d0a2a2043616368696e67206f6620726573756c7420736574206f6620636f64652d636f6d706c6574696f6e20666f722073706565642d75702e0d0a2a204e6577206f7074696f6e2022457865637574696f6e2f506172616d6574657273222028616e64202244656275672f506172616d657465727322292e0d0a0d0a56657273696f6e20342e392e352e302028352e3020626574612035293a0d0a2a204350552057696e646f7720287374696c6c20696e20646576656c6f706d656e74290d0a2a20546f446f20206c6973740d0a2a204261636b747261636520696e20646562756767696e670d0a2a2052756e20746f20637572736f720d0a2a20466f6c6465727320696e2050726f6a65637420616e6420436c6173732042726f777365720d0a2a2053656e6420637573746f6d20636f6d6d616e647320746f204744420d0a2a204d616b6566696c652063616e206e6f7720626520637573746f6d697a65642e0d0a2a204d6f64696669656420746865206265686176696f7572206f6620746865202d6320706172616d203a3d32300d0a20202d63203c636f6e6669672066696c65206469726563746f72793e0d0a2a20536176696e67206f6620637573746f6d2073796e74617820706172616d657465722067726f75700d0a2a20506f73736962696c697479206f66206368616e67696e6720636f6d70696c65727320616e6420746f6f6c732066696c656e616d652e0d0a2a204d616e79206275672066697865730d0a0d0a0d0a56657273696f6e20342e392e342e312028352e30206265746120342e31293a0d0a0d0a2a206261636b20746f2067636320322e39352e330d0a2a2050726f66696c696e6720737570706f72740d0a2a206e6577207570646174652f7061636b6167657320636865636b6572202876557064617465290d0a2a204c6f7473206f662062756766697865730d0a0d0a2d2d2d2d2d2d3d5f4e657874506172745f3030305f3030")

test_parse_smtp_res()
test_parse_smtp_req()
test_parse_smtp_data()